+ do a graphical profile of nn evaluator
+ rewrite solve_geometry in C if it is the bottleneck
